(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{422:function(l,t,v){"use strict";v.r(t);var i=v(55),_=Object(i.a)({},(function(){var l=this,t=l.$createElement,v=l._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":l.$parent.slotKey}},[v("h1",{attrs:{id:"性能优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#性能优化"}},[l._v("#")]),l._v(" 性能优化")]),l._v(" "),v("h2",{attrs:{id:"main-函数之前的耗时流程-pre-main"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#main-函数之前的耗时流程-pre-main"}},[l._v("#")]),l._v(" main 函数之前的耗时流程(pre-main)")]),l._v(" "),v("ul",[v("li",[v("ol",[v("li",[l._v("动态库的加载")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"2"}},[v("li",[l._v("rebase/rebinding(偏移修正/符号绑定)")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"3"}},[v("li",[l._v("ObjC setup：runtime运行时初始化")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"4"}},[v("li",[l._v("load函数的加载")])])])]),l._v(" "),v("h2",{attrs:{id:"app-冷启动阶段优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#app-冷启动阶段优化"}},[l._v("#")]),l._v(" App 冷启动阶段优化")]),l._v(" "),v("p",[l._v("App 冷启动可分为三个阶段：dyld 阶段、Runtime 阶段、main 阶段")]),l._v(" "),v("ul",[v("li",[v("p",[l._v("dyld 阶段优化：")]),l._v(" "),v("ul",[v("li",[v("ol",[v("li",[l._v("减少动态库、合并动态库，定期清理不必要的动态库，动态库不要超过6个，官方建议")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"2"}},[v("li",[l._v("减少类、分类的数量，减少 Selector 的数量，定期清理不必要的类、分类")])])])])]),l._v(" "),v("li",[v("p",[l._v("Runtime阶段优化")]),l._v(" "),v("ul",[v("li",[v("ol",[v("li",[l._v("减少load函数，考虑渲染完成后再加载")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"2"}},[v("li",[l._v("使用+initialize()的方法代替+load()，注意把逻辑移动到+initialize()时，要注意避免+initialize()的重复调用问题，可以使用dispatch_once()让逻辑只执行一次")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"3"}},[v("li",[l._v("二进制文件重排")])])])])]),l._v(" "),v("li",[v("p",[l._v("main 阶段优化")]),l._v(" "),v("ul",[v("li",[v("ol",[v("li",[l._v("使用纯代码布局，不要用storyboard、xib")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"2"}},[v("li",[l._v("将一些耗时操作延迟执行或异步处理")])])])])])]),l._v(" "),v("h2",{attrs:{id:"提高ios项目的编译速度"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#提高ios项目的编译速度"}},[l._v("#")]),l._v(" 提高iOS项目的编译速度")]),l._v(" "),v("p",[l._v("CCache 是一个能够把编译的中间产物缓存起来的工具")]),l._v(" "),v("h2",{attrs:{id:"uitableview性能优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#uitableview性能优化"}},[l._v("#")]),l._v(" UITableView性能优化")]),l._v(" "),v("p",[v("a",{attrs:{href:"https://www.cnblogs.com/fengmin/p/5363882.html",target:"_blank",rel:"noopener noreferrer"}},[l._v("参考文献"),v("OutboundLink")],1)]),l._v(" "),v("ul",[v("li",[v("ol",[v("li",[l._v("拿到网络数据后先遍历计算好对应cell的高度")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"2"}},[v("li",[l._v("使用纯码编写cell代码，减少视图的数量、层次、不要动态添加subView")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"3"}},[v("li",[l._v("图片异步加载，不要触发离屏渲染(GPU在当前屏幕缓冲区以外开辟一个缓冲区进行渲染操作)")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"4"}},[v("li",[l._v("滑动时按需加载对应的内容，如果目标行与当前行相差超过指定行数，只加载滑动结束时屏幕所见的cell。")])])])]),l._v(" "),v("h2",{attrs:{id:"性能优化-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#性能优化-2"}},[l._v("#")]),l._v(" 性能优化")]),l._v(" "),v("ul",[v("li",[v("ol",[v("li",[l._v("内存优化")])]),l._v(" "),v("ul",[v("li",[l._v("1.1 内存泄漏，避免循环引用，(block/定时器/delegate/Network)可以使用MLeaksFinder监控内存泄漏")]),l._v(" "),v("li",[l._v("1.2 大量数据遍历的时候，在循环内部使用自动释放池")]),l._v(" "),v("li",[l._v("1.3 重用大开销对象，如日期转换类和日历类")]),l._v(" "),v("li",[l._v("1.4 图片缓存")]),l._v(" "),v("li",[l._v("1.5 使用懒加载")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"2"}},[v("li",[l._v("界面优化")])]),l._v(" "),v("ul",[v("li",[l._v("2.1 尽量使用纯代码编写页面，不要使用xib、storyboard")]),l._v(" "),v("li",[l._v("2.2 尽量避免离屏渲染")]),l._v(" "),v("li",[l._v("2.3 TableView的优化")]),l._v(" "),v("li",[l._v("2.4 重用和延迟加载Views")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"3"}},[v("li",[l._v("启动优化\n见冷启动优化(如上)")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"4"}},[v("li",[l._v("网络优化")])]),l._v(" "),v("ul",[v("li",[l._v("4.1 优化DNS解析和缓存")]),l._v(" "),v("li",[l._v("4.2 对传输的数据进行压缩，减少传输的数据")]),l._v(" "),v("li",[l._v("4.3 使用缓存手段减少请求的发起次数")]),l._v(" "),v("li",[l._v("4.4 使用策略来减少请求的发起次数，比如在上一个请求未着地之前，不进行新的请求")]),l._v(" "),v("li",[l._v("4.5 避免网络抖动，提供重发机制")])])])]),l._v(" "),v("h2",{attrs:{id:"耗电量检测与优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#耗电量检测与优化"}},[l._v("#")]),l._v(" 耗电量检测与优化")]),l._v(" "),v("p",[l._v("影响电量的五个因素：CPU、GPU、Network、Location、Background")]),l._v(" "),v("p",[l._v("耗电量优化：")]),l._v(" "),v("ul",[v("li",[v("p",[l._v("一、代码层面")]),l._v(" "),v("ul",[v("li",[v("ol",[v("li",[l._v("合理使用NSDateFormatter 和 NSCalendar这种高开销对象")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"2"}},[v("li",[l._v("不要频繁的刷新页面,能刷新1行cell最好只刷新一行,尽量不要使用reloadData")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"3"}},[v("li",[l._v("选择正确的集合")])]),l._v(" "),v("ul",[v("li",[l._v("NSArray,使用index来查找很快(插入和删除很慢)")]),l._v(" "),v("li",[l._v("字典,使用键来查找很快")]),l._v(" "),v("li",[l._v("NSSets,是无序的,用键查找很快,插入/删除很快")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"4"}},[v("li",[l._v("少用运算获得圆角,不论view.maskToBounds还是layer.clipToBounds都会有很大的资源开销,必须要用圆角的话,不如把图片本身就做成圆角")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"5"}},[v("li",[l._v("懒加载,不要一次性创建所有的subview,而是需要时才创建.")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"6"}},[v("li",[l._v("重用。可以模仿UITableView和UICollectionView,不要一次性创建所有的subview,而是需要时才创建.完成了使命,把他放入到一个可重用集合中")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"7"}},[v("li",[l._v("图片处理")])]),l._v(" "),v("ul",[v("li",[l._v("图片与imageView相同大小,避免多余运算")]),l._v(" "),v("li",[l._v("可以使用整副的图片,增加应用体积,但是节省CPU")]),l._v(" "),v("li",[l._v("可调大小的图片,可以省去一些不必要的空间")]),l._v(" "),v("li",[l._v("CALayer,CoreGraphics,甚至OpenGL来绘制,消耗CPU")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"8"}},[v("li",[l._v("cache,cache,cache(缓存所有需要的)")])]),l._v(" "),v("ul",[v("li",[l._v("服务器相应结果的缓存(图片)")]),l._v(" "),v("li",[l._v("复杂计算结果的缓存(UITableView的行高)")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"9"}},[v("li",[l._v("尽量少用透明或半透明,会产生额外的运算.")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"10"}},[v("li",[l._v("使用ARC减少内存失误,dealloc需要重写并对属性置为nil")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"11"}},[v("li",[l._v("避免庞大的xib,storyBoard,尽量使用纯代码开发")])])])])]),l._v(" "),v("li",[v("p",[l._v("二、CPU层面")]),l._v(" "),v("ul",[v("li",[v("ol",[v("li",[l._v("Timer的时间间隔不宜太短,满足需求即可")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"2"}},[v("li",[l._v("线程适量,不宜过多,不要阻塞主线程")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"3"}},[v("li",[l._v("优化算法,减少循环次数")])])]),l._v(" "),v("li",[v("ol",{attrs:{start:"4"}},[v("li",[l._v("定位和蓝牙按需取用,定位之后要关闭或降低定位频率")])])])])])]),l._v(" "),v("h2",{attrs:{id:"性能优化-3"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#性能优化-3"}},[l._v("#")]),l._v(" 性能优化")]),l._v(" "),v("p",[v("a",{attrs:{href:"https://www.jianshu.com/p/9c450e512020",target:"_blank",rel:"noopener noreferrer"}},[l._v("参考文献"),v("OutboundLink")],1)]),l._v(" "),v("ol",[v("li",[v("p",[l._v("用ARC管理内存")])]),l._v(" "),v("li",[v("p",[l._v("在正确的地方使用reuseIdentifier")])]),l._v(" "),v("li",[v("p",[l._v("尽可能使Views不透明")])]),l._v(" "),v("li",[v("p",[l._v("避免庞大的XIB")])]),l._v(" "),v("li",[v("p",[l._v("不要block主线程")])]),l._v(" "),v("li",[v("p",[l._v("在Image Views中调整图片大小")])]),l._v(" "),v("li",[v("p",[l._v("选择正确的Collection")])]),l._v(" "),v("li",[v("p",[l._v("打开gzip压缩")])]),l._v(" "),v("li",[v("p",[l._v("重用和延迟加载Views")])]),l._v(" "),v("li",[v("p",[l._v("Cache, Cache, 还是Cache！")])]),l._v(" "),v("li",[v("p",[l._v("权衡渲染方法")])]),l._v(" "),v("li",[v("p",[l._v("处理内存警告")])]),l._v(" "),v("li",[v("p",[l._v("重用大开销的对象")])]),l._v(" "),v("li",[v("p",[l._v("使用Sprite Sheets")])]),l._v(" "),v("li",[v("p",[l._v("避免反复处理数据")])]),l._v(" "),v("li",[v("p",[l._v("选择正确的数据格式")])]),l._v(" "),v("li",[v("p",[l._v("正确地设定Background Images")])]),l._v(" "),v("li",[v("p",[l._v("减少使用Web特性")])]),l._v(" "),v("li",[v("p",[l._v("设定Shadow Path")])]),l._v(" "),v("li",[v("p",[l._v("优化你的Table View")])]),l._v(" "),v("li",[v("p",[l._v("选择正确的数据存储选项")])]),l._v(" "),v("li",[v("p",[l._v("加速启动时间")])]),l._v(" "),v("li",[v("p",[l._v("使用Autorelease Pool")])]),l._v(" "),v("li",[v("p",[l._v("选择是否缓存图片")])]),l._v(" "),v("li",[v("p",[l._v("尽量避免日期格式转换")])])])])}),[],!1,null,null,null);t.default=_.exports}}]);